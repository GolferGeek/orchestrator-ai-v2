# Task List: AI Agent Voice Features
# Source: docs/PRD-voice-features.md

1. Set up Web Speech API for text-to-voice (TTS) in the app
   - Integrate browser-native TTS for reading text aloud
   - Provide instant playback with user feedback (e.g., play indicator)

2. Implement Unreal Speech API as TTS fallback
   - Integrate Unreal Speech API for browsers/devices where Web Speech API is unavailable or unsatisfactory
   - Ensure seamless fallback logic

3. Add UI for TTS triggers
   - Enable 'Read Aloud' option in right-click context menu for highlighted text

4. Set up Web Speech API for voice-to-text (STT) in the app
   - Integrate browser-native STT for transcribing speech to text
   - Display transcribed text in chat bar automatically
   - Show sound wave or similar animation to indicate listening

5. Implement Deepgram API as STT fallback
   - Integrate Deepgram API for browsers/devices where Web Speech API is unavailable, errors, or returns empty/obviously bad results
   - Use Deepgram if Web Speech API confidence score is below threshold (e.g., 0.7) and trustworthy
   - Handle 'suspicious' confidence values (e.g., always 0.5 or 1.0) by only falling back on errors or empty results

6. Add UI for STT triggers
   - Add mic icon next to chat bar to start/stop voice input
   - Provide clear visual indicator when listening is active

7. Implement agent logic for TTS/STT management
   - Automate fallback and error handling for both TTS and STT
   - Ensure all voice features are user-initiated (via UI or commands)
   - Inform users if/when audio is sent to a cloud service
   - Store API keys securely (never in frontend code)
   - Implement environment variable management for API keys (e.g., use dotenv for Node.js, Capacitor config for mobile)
   - Log fallback frequency and confidence score patterns for future tuning (use a lightweight analytics service such as LogRocket or Sentry, and custom event logging for fallback/confidence events)
   - Display user-friendly error messages when voice features fail

8. Ensure cross-platform support
   - Test and validate all features on both web and mobile (Ionic/Capacitor)
   - Test across all major browsers and devices (Chrome, Firefox, Safari, Edge, iOS, Android)
   - Perform accessibility testing (e.g., ARIA labels, keyboard navigation, screen reader compatibility)
   - Perform performance testing (e.g., latency of TTS/STT, fallback response times)

# Stretch goals and advanced features are documented in the PRD and not included in this initial task list. 